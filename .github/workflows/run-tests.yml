name: ðŸ§ª Run Java Tests (Verbose)
on:
 push:
   branches: [ main, develop ]
 pull_request:
   branches: [ main, develop ]
jobs:
 build:
   runs-on: ubuntu-latest
   steps:
     - name: ðŸ§© Checkout repository
       uses: actions/checkout@v4
     - name: â˜• Set up Java 17
       uses: actions/setup-java@v4
       with:
         distribution: 'temurin'
         java-version: '17'
     - name: ðŸ§° Download JUnit Console
       run: |
         mkdir -p libs
         curl -L -o libs/junit-platform-console-standalone.jar https://repo1.maven.org/maven2/org/junit/platform/junit-platform-console-standalone/1.9.3/junit-platform-console-standalone-1.9.3.jar
     - name: ðŸ§¹ Compile main Java files (with verbose logs)
       run: |
         set -e
         mkdir -p out
         if [ -d "ReturnABook/src" ]; then
           ROOT="ReturnABook/src"
         else
           ROOT="src"
         fi
         echo "Using source root: $ROOT"
         find "$ROOT" -type f -name "*.java" > main-sources.txt || echo "âš ï¸ No Java files found!"
         echo "Compiling sources..."
         javac -d out -encoding UTF-8 -cp libs/junit-platform-console-standalone.jar @"main-sources.txt" 2> compile-main.log || true
         echo "---- JAVAC OUTPUT ----"
         cat compile-main.log || echo "no compile-main.log"
         echo "----------------------"
     - name: ðŸ§ª Run JUnit tests (if any)
       run: |
         if [ -d "ReturnABook/src/test/java" ]; then
           TESTROOT="ReturnABook/src/test/java"
         elif [ -d "src/test/java" ]; then
           TESTROOT="src/test/java"
         else
           echo "â„¹ï¸ No test sources found. Skipping tests."
           exit 0
         fi
         echo "Found test sources in $TESTROOT"
         find "$TESTROOT" -type f -name "*.java" > test-sources.txt
         javac -d out -encoding UTF-8 -cp "libs/junit-platform-console-standalone.jar:out" @"test-sources.txt" 2> compile-test.log || true
         echo "---- TEST COMPILE OUTPUT ----"
         cat compile-test.log || echo "no compile-test.log"
         echo "------------------------------"
         java -jar libs/junit-platform-console-standalone.jar \
           --class-path out \
           --scan-class-path || true
